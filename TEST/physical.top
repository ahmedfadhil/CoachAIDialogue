topic: ~physical keep repeat []

u: INTRO ($physical=0 * ~topic_attivita_fisica * )
	Essere in forma non √® solo una buona scusa per indossare i leggins üòã
	E' il modo migliore per mantenere la tua mente e il tuo corpo in ottima forma üëç
	E ci sono tanti modi divertenti che puoi farlo! üéâ
	$physical=1
	^reuse(FITNESS_ACTIVITY)

u: FITNESS_ACTIVITY ($physical=1)
	Quindi $username, quale e' la tua attivita' preferita di sport üèãÔ∏è? 

	$_responses = ^jsoncreate(array)
    ^jsonarrayinsert($_responses "ciclismo")
    ^jsonarrayinsert($_responses "nuoto")
    ^jsonarrayinsert($_responses "corsa")
    ^jsonarrayinsert($_responses "yoga")
    ^jsonarrayinsert($_responses "danza")
    ^jsonarrayinsert($_responses "sport di squadra")
    ^jsonarrayinsert($_responses "camminare")
    ^jsonarrayinsert($_responses "non ho uno sport preferito")

    $USER.buttons = $_responses

	$physical=2

u: ($physical=2 * ciclismo *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "ciclismo"
	^reuse(OFTEN)

u: ($physical=2 * nuoto *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "nuoto"
	^reuse(OFTEN)

u: ($physical=2 * corsa *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "corsa"
	^reuse(OFTEN)

u: ($physical=2 * yoga *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "yoga"
	^reuse(OFTEN)

u: ($physical=2 * danza *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "danza"
	^reuse(OFTEN)

u: ($physical=2 * squadra *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "sport di squadra"
	^reuse(OFTEN)

u: ($physical=2 * camminare *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "camminare"
	^reuse(OFTEN)

u: ($physical=2 * non ho uno sport preferito *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=4
	$USER.physical_features.sport = "nessuno sport preferito"
	^reuse(OFTEN)


# AGGIUNGERO UNA REGOLA PER OGNI SPORT ALTRIMENTI NON FUNZIONA


u: OFTEN ($physical=4)
	Quanto spesso ti eserciti? Per favore scegli una delle opzioni qua sotto üëá.
	
	$_responses = ^jsoncreate(array)
    ^jsonarrayinsert($_responses "3 o piu' volte a settimana")
    ^jsonarrayinsert($_responses "1 / 2 volte a settimana")
    ^jsonarrayinsert($_responses "quasi mai")

    $USER.buttons = $_responses
    $physical=5

u: ($physical=5 * 3 *)
	Molto bene! Pure io mi tengo sempre allenato cosa credi.
	$physical=6
	$USER.physical_features.physical_sport_frequency = "3 o piu volte in settimana"
	^reuse(INTENSITY)


u: ($physical=5 * 1 * {2} * )
	Non c'e' guadagno senza dolore üò£.
	$physical=6
	$USER.physical_features.physical_sport_frequency = "1 / 2 volte in settimana"
	^reuse(INTENSITY)

u: ($physical=5 * quasi mai * )
	Sarebbe l'ora di iniziare. I benefici sono infiniti!
	$physical=6
	$USER.physical_features.physical_sport_frequency = "quasi mai"
	^reuse(INTENSITY)


u: INTENSITY ($physical=6)
	Con che intensita' ti eserciti?

	$_responses = ^jsoncreate(array)
    ^jsonarrayinsert($_responses "tranquilla")
    ^jsonarrayinsert($_responses "media")
    ^jsonarrayinsert($_responses "ci vado pesante")

    $USER.buttons = $_responses
	
	$physical=7

u: ($physical=7 * [tranquillo tranquilla] *)
	Molto bene! ü§û Meglio tranquilli e farlo piuttosto che non fare niente.
	$physical=8
	$USER.physical_features.physical_sport_intensity = "tranquilla"
	^reuse(FITNESS_OBJ)

u: ($physical=7  * media *)
	Molto bene! ü§û
	$physical=8
	$USER.physical_features.physical_sport_intensity = "media"
	^reuse(FITNESS_OBJ)

u: ($physical=7  * pesante *)
	Molto bene! ü§û Immagino che ti diverta molto üòä.
	$physical=8
	$USER.physical_features.physical_sport_intensity = "pesante"
	^reuse(FITNESS_OBJ)

u: FITNESS_OBJ ($physical=8)üë£
	Il tuo lavoro richiede di piu' stare seduti o muoversi?
	
	$_responses = ^jsoncreate(array)
    ^jsonarrayinsert($_responses "muoversi")
    ^jsonarrayinsert($_responses "entrambe")
    ^jsonarrayinsert($_responses "stare_seduti")

    $USER.buttons = $_responses	
	$physical=9

u: ($physical=9 * muoversi * )
	Ooooooh yesss! Sono molto bravo a fare questo. Posso aiutarti molto nel raggiungere i tuoi obiettivi
	$physical=10
	$USER.physical_features.work_physical_activity = 2
	^reuse(FOOT_BICYCLE)

u: ($physical=9 * entrambe * )
	Ooooooh yesss! Sono molto bravo a fare questo. Posso aiutarti molto nel raggiungere i tuoi obiettivi
	$physical=10
	$USER.physical_features.work_physical_activity = 1
	^reuse(FOOT_BICYCLE)

u: ($physical=9 * stare seduti * )
	Ooooooh yesss! Sono molto bravo a fare questo. Posso aiutarti molto nel raggiungere i tuoi obiettivi
	$physical=10
	$USER.physical_features.work_physical_activity = 0
	^reuse(FOOT_BICYCLE)

u: FOOT_BICYCLE ($physical=10) Quanto spesso vai in giro in bicicletta o a piedi?
	$_responses = ^jsoncreate(array)
    ^jsonarrayinsert($_responses "spesso")
    ^jsonarrayinsert($_responses "a volte")
    ^jsonarrayinsert($_responses "raramente")

    $USER.buttons = $_responses
    $physical=11

u: ($physical=11 * spesso * )
	Molto bene! Sei una persona carica!
	$physical=12
	$USER.physical_features.foot_bicycle = 2
	^reuse(FINISH_PHYSICAL)

u: ($physical=11 * a volte * )
	Meglio di niente.
	$physical=12
	$USER.physical_features.foot_bicycle = 1
	^reuse(FINISH_PHYSICAL)

u: ($physical=11 * raramente * )
	Ogni tanto dovresti sforzarti a farlo!
	$physical=12
	$USER.physical_features.foot_bicycle = 0
	^reuse(FINISH_PHYSICAL)


u: FINISH_PHYSICAL ($physical=12 )
	# set topic completed
    $USER.physical = 1
	^flag_on_profiling_done($USER.health $USER.coping $USER.physical $USER.mental)

	if ($USER.state!=1){
		Per ora abbiamo finito di parlare di attivita' fisiche, penser√≤ ad un piano da battaglia ü§∫ per te ma durante l'attesa possiamo chattare di altro.
		^mark(back _0)
	    ^respond(~profilation)
	}else{
		$USER.monitoring=1
		^respond(~monitoring)
	}


u: STOP ( * ~stop_here * )
    üôà Va bene, decidi tu capo di cosa parliamo üòÅüòÜ Io vado a lavarmi i denti üòÅüòÅ quando cambi
    idea vieni qui e chiedimi di parlare di salute. Io resto qui ad aspettarti. A dopo!

	^calculate_physical_default()
    $profilation=0
    ^respond(~profilation)

u: (ciaoooo)
	Ottimo abbiamo tutto il necessario per dare il via alla definizione delle attivita'.
	^respond(~monitoring)

u: DEFAULT ()
	Che asino che sono üêéüôà! Penso di non aver capito ma mi sa che eravamo rimasti qua.. 

	# check user topic fullfilment state
	if($physical==0){
		^reuse(INTRO)
	}else if($physical==2 OR $physical==3){
		$physical=1
		^reuse(FITNESS_ACTIVITY)
	}else if($physical==5){
		$physical=4
		^reuse(OFTEN)
	}else if($physical==7){
		$physical=6
		^reuse(INTENSITY)
	}else if($physical==9){
		$physical=8
		^reuse(FITNESS_OBJ)
	}else if($physical==11){
		$physical=10
		^reuse(FOOT_BICYCLE)
	}



